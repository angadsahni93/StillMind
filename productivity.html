<!-- productivity.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Productivity | StillMind</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- WordCloud2.js -->
  <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.1.2/src/wordcloud2.min.js"></script>
  <!-- SheetJS for XLSX parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body class="bg-white text-gray-400 font-light tracking-wide text-sm leading-relaxed">

  <!-- Navbar -->
  <header>
    <div id="navbar-placeholder"></div>
  </header>
  <script>
    fetch('navbar.html')
      .then(r => r.text())
      .then(html => document.getElementById('navbar-placeholder').innerHTML = html);
  </script>

  <main class="pt-10 pb-24 px-6 max-w-4xl mx-auto space-y-10 text-center">

    <!-- Back + Title -->
    <div class="flex items-center justify-left space-x-4 mb-6">
      <a href="aboutus.html"
         class="bg-orange-200 text-gray-700 font-semibold py-2 px-4 rounded-2xl hover:bg-gradient-to-r from-emerald-700 to-gray-500 hover:text-white transition-colors">
        <span aria-label="lotus" role="img" style="font-size:1.8rem;position:relative;top:0.1rem">‚Üê üîóüìñ</span>
      </a>
      <section class="bg-gray-50 rounded-2xl shadow-sm p-6 max-w-3xl mx-auto text-left space-y-4">
        <h2 class="text-4xl text-gray-500 font-semibold tracking-wider flex items-center">
          Productivity
          <span aria-label="money" role="img" style="font-size:2.5rem; margin-left:0.15rem">üåü</span>
        </h2>
      </section>
    </div>

    <!-- Mission Statement -->
    <section class="bg-gray-50 rounded-2xl shadow-sm p-6 max-w-3xl mx-auto text-left space-y-4">
      <h3 class="text-xl text-gray-600 font-semibold">Mission Statement</h3>
      <p class="text-gray-500">
        NOTE: Mission is to find research that examines the Productivity of interventions.
      </p>
      <h3 class="text-m text-gray-600 font-semibold">
        Question: <span class="italic text-gray-600">Which interventions give the best value for money?</span>
      </h3>
    </section>

    <!-- Word Cloud Section -->
    <section class="bg-gray-50 rounded-2xl shadow-sm p-6 max-w-6xl mx-auto text-center">
      <h3 class="text-4xl text-gray-600 font-semibold mb-1">Keywords</h3>
</section>
<section>
      <canvas id="wordcloud-canvas" class="mx-auto" align="centre" width="2000" height="800"></canvas>
    </section>



    <!-- WordCloud Script -->
<script>
  (async function() {
    // 1) fetch and parse research_prod.xlsx
    const buffer = await fetch('research_prod.xlsx')
      .then(r => { if (!r.ok) throw new Error('Fetch failed'); return r.arrayBuffer(); });
    const wb = XLSX.read(buffer, { type: 'array' });
    const ws = wb.Sheets[wb.SheetNames[0]];
    const data = XLSX.utils.sheet_to_json(ws, { defval: '' });

    // 2) build keyword frequency map
    const freq = {};
    data.forEach(row => {
      if (!row.keywordslowcase) return;
      row.keywordslowcase.split(/[,;]+/).forEach(raw => {
        const term = raw.trim(); // normalize case
        if (!term) return;
        freq[term] = (freq[term] || 0) + 1;
      });
    });

    // 3) sort by frequency
    const allWords = Object.entries(freq)
      .map(([w, c]) => [w, Number(c)])
      .sort((a, b) => b[1] - a[1]);

    // ‚úÖ enforce top 10
    const words = allWords.slice(0, 15);

    if (!words.length) {
      console.warn('No keywords for cloud.');
      return;
    }

    // 4) colors & sizing
    const palette = [
      '#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF','#FF9F40',
      '#DC143C','#00BFFF','#228B22','#DAA520','#DA70D6',
      '#FF7F50','#708090','#FF6347','#9370DB','#40E0D0',
      '#B22222','#6B8E23','#4682B4','#FF69B4','#CD853F',
      '#F5FFFA','#4169E1','#FFFACD','#8B4513','#2E8B57'
    ];

    const maxCount = Math.max(...words.map(w => w[1]));

    // 5) render
    WordCloud(document.getElementById('wordcloud-canvas'), {
      list: words, // ‚Üê only 10 words
      gridSize: 9,
      weightFactor: c => (c / maxCount) * 90,
      fontFamily: 'sans-serif, Helvetica',
      color: () => palette[Math.floor(Math.random() * palette.length)],
      rotateRatio: 0.2,   // 20% chance rotation
      rotationSteps: 3,
      shuffle: true,
      backgroundColor: 'black',
      ellipticity: 0.9,
      origin: [400, 400], // x, y
      drawOutOfBound: false,
      clearCanvas: true
    });
  })().catch(console.error);
</script>


    <!-- Research Entries Placeholder -->
    <div id="research-sections" class="space-y-8 px-6 max-w-4xl mx-auto"></div>

    <!-- Research Entries Script -->
    <script>
      fetch('research_prod.xlsx')
        .then(r => r.arrayBuffer())
        .then(ab => {
          const wb = XLSX.read(ab, { type: 'array' });
          const ws = wb.Sheets[wb.SheetNames[0]];
          const rows = XLSX.utils.sheet_to_json(ws, { defval: '' });
          const container = document.getElementById('research-sections');
          if (!rows.length) return container.innerText = 'No research data found.';
          rows.forEach(row => {
            container.insertAdjacentHTML('beforeend', `
              <br>
              <section class="bg-gray-100 rounded-2xl shadow-sm p-6 text-left space-y-2">
                <h2 class="text-xl font-bold text-gray-700">${row.Number}. 
                  <a href="${row.Link}" target="_blank" class="hover:underline hover:bg-blue-200">
                    ${row.Title}
                  </a> (${row.Year})
                </h2>
                <p class="block text-sm text-gray-600">${row.Authors || ''}</p>
                <p class="text-sm text-gray-800">
                  <b>Keywords:</b> ${row.keywordslowcase}
                </p>

                <br>
                <p class="text-gray-800">
                  <b>Summary:</b> ${row.Summary}
                </p>
                
                <br>
                <p class="text-gray-800">
                  <b>Limitations:</b> ${row.Limitations}
                </p>
              </section>
            `);
          });
        })
        .catch(err => {
          console.error(err);
          document.getElementById('research-sections').innerText = 'Failed to load research_prod.xlsx';
        });
    </script>

  </main>

  <footer class="text-center text-xs text-gray-300 py-8 border-t border-gray-200 mt-10">
    ¬© 2025 StillMind. All rights reserved.
  </footer>

</body>
</html>

